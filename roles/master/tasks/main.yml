- name: "Initialize docker swarm instance and caputure ID"
  shell: "docker swarm init --advertise-addr {{ ansible_default_ipv4.address }}"
  register: docker_id
  ignore_errors: yes

- name: "Display docker swarm token ID"
  shell: "docker swarm join-token manager | awk '{if(NR>1)print}'"
  register: docker_id_number

- name: "Add Token and to dummy host, used to pass variable to other playbook"
  add_host:
    name:   "MASTER_TOKEN_HOLDER"
    token:  "{{ docker_id_number.stdout }}"

- debug:
    var: ansible_default_ipv4.address
